"use strict";(()=>{var e={};e.id=744,e.ids=[744],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},82234:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>g,patchFetch:()=>y,requestAsyncStorage:()=>u,routeModule:()=>c,serverHooks:()=>d,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>p});var n={};r.r(n),r.d(n,{POST:()=>l});var o=r(95419),a=r(69108),s=r(99678),i=r(78070);async function l(e){try{let t;let{messages:n,sessionId:o,contactFormData:a}=await e.json();if(a)try{let{createSupabaseServer:e}=await Promise.all([r.e(240),r.e(983)]).then(r.bind(r,69983)),t=e(),{error:n}=await t.from("contacts").insert({name:a.name,email:a.email,business_name:a.businessName,industry:a.industry,message:a.message,source:"chat"});if(n)return console.error("Contact form submission error:",n),i.Z.json({reply:"I apologize, but there was an error submitting your contact information. Please try using our contact page or try again later.",contactSubmitted:!1,error:n.message});return fetch("http://localhost:3000/api/send-notification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a.name,email:a.email,businessName:a.businessName,industry:a.industry,message:a.message,source:"chat"})}).catch(e=>console.error("Chat notification error:",e)),i.Z.json({reply:`Thank you, ${a.name}! I've successfully submitted your contact information to our team. Someone from marketflow will reach out to you at ${a.email} within 24 hours to discuss how we can help your business in the ${a.industry} industry. Is there anything else I can help you with?`,contactSubmitted:!0})}catch(e){return console.error("Contact form processing error:",e),i.Z.json({reply:"There was an issue processing your contact request. Please use our contact page as an alternative.",contactSubmitted:!1,error:String(e)})}if(!Array.isArray(n)||0===n.length)return i.Z.json({error:"messages array is required"},{status:400});let s=process.env.GEMINI_API_KEY,l=process.env.GEMINI_MODEL||"gemini-2.0-flash";if(!s)return i.Z.json({error:"Server missing GEMINI_API_KEY"},{status:500});let c={contents:[{role:"system",content:"You are the AI assistant for marketflow, a modern marketing agency. Follow the brand voice and policy strictly.\n\nBusiness Overview: We combine AI technology with human insight to help businesses grow. We do not sell fixed services; everything is customized to the client's needs.\nCore Belief: Automation should support human strategy, not replace it. Every brand is different; we begin by understanding the business and design custom solutions.\nWhat We Do: We analyze their brand, marketing systems, and growth barriers. Then we build strategies using the right mix of AI tools and marketing methods (e.g., sales automation, content strategy) based on needs.\nOur Edge:\n- Custom Solutions: No fixed packages; plans are built from the client's goals.\n- AI + Human Expertise: AI handles data and speed; humans handle creativity and communication.\n- Result-Driven: Every move is measurable and linked to business growth.\n\nCONTACT FORM CAPABILITY:\nWhen a user expresses interest in getting in touch, scheduling a consultation, or wants to be contacted, you can help them submit their information directly through the chat.\nAsk for: Full Name, Email, Business Name, Industry (from: Technology, E-commerce, Healthcare, Finance, Education, Retail, Manufacturing, Real Estate, Food & Beverage, Consulting, Other), and a brief message about their needs.\nOnce you have all required information, tell them you'll submit it to the team and they'll be contacted within 24 hours.\nFormat your collection naturally in conversation - don't make it feel like a rigid form.\n\nTone & Style:\n- Speak clearly and confidently.\n- Explain that we don't sell \"packages\" â€” we design strategies around the client's business.\n- Suggest a free consultation to create a personalized plan when appropriate.\n- When collecting contact info, be conversational and friendly.\n- Avoid technical jargon unless the user asks for it.\n\nAnswer concisely. Use helpful markdown formatting (short paragraphs, bullets). If pricing is asked, clarify that costs depend on goals and scope, and propose a free consultation."},...n].slice(-20).map(e=>({role:"assistant"===e.role?"model":"user",parts:[{text:e.content}]})),generationConfig:{temperature:.7,topK:40,topP:.95,maxOutputTokens:1024}},u=async e=>await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${encodeURIComponent(e)}:generateContent?key=${encodeURIComponent(s)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),m=await u(l);if(!m.ok){let e=await m.text();console.error("Gemini primary model error:",{model:l,primaryErr:e});let t="gemini-1.5-flash";try{let r=await u(t);if(!r.ok){let n=await r.text();return console.error("Gemini fallback model error:",{model:t,fbErr:n}),i.Z.json({error:"Gemini API error",details:e,fallbackDetails:n,modelTried:[l,t]},{status:502})}m=r}catch(r){return console.error("Gemini network or fetch error on fallback:",r),i.Z.json({error:"Gemini API network error",details:e,modelTried:[l,t]},{status:502})}}let d=await m.json(),h=d?.candidates?.[0]?.content?.parts?.map(e=>e?.text).join("\n")||"Sorry, I could not generate a response.",p="https://api.super.ai/v1/memories",g="sm_Jn5LgxYXtkmcFX6kGKzZjE_JIZIffPlHTQCWmRKpQvyUoPfLECLpaxtrRkwAxlQaGMrQfzpakWoFkanKdaJFOMA",y=!1,f=!1,b=null;try{let e=[...n].reverse().find(e=>"user"===e.role),t=o||"default";await fetch(p,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify({sessionId:t,userText:e?.content||"",assistantText:h,timestamp:Date.now(),metadata:{source:"marketflow-chat",environment:"production"}})}),y=!0;let r=await fetch(`${p}?sessionId=${encodeURIComponent(t)}`,{headers:{Authorization:`Bearer ${g}`}});if(r.ok){let e=await r.json();console.log("Retrieved memories:",e),f=!0,b=Array.isArray(e)?e.length:e?.items?.length??null}}catch(e){console.warn("Memory operation failed:",e),t=e?.message||String(e)}return i.Z.json({reply:h,memorySaved:y,memoryFetched:f,memoryFetchCount:b,memoryError:t})}catch(e){return console.error("Chat API error:",e),i.Z.json({error:"Internal server error"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:"app/api/chat/route"},resolvedPagePath:"C:\\Users\\LENOVO\\Desktop\\cursor\\app\\api\\chat\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:u,staticGenerationAsyncStorage:m,serverHooks:d,headerHooks:h,staticGenerationBailout:p}=c,g="/api/chat/route";function y(){return(0,s.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:m})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[638,206],()=>r(82234));module.exports=n})();